<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Scheduling Simulator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Mobile Header -->
    <header class="mobile-header">
        <span class="mobile-logo">ðŸŒ¸</span>
        <span class="mobile-title">CPU Scheduler</span>
        <span class="mobile-logo">ðŸŒ¸</span>
    </header>

    <div class="container">
        <h1>CPU Scheduler Visualizer</h1>

        <div class="layout-wrapper">

            <div class="main-content">
                <div class="glass-panel controls" style="grid-template-columns: repeat(2, 1fr);">
                    <!-- ROW: Algorithm + Time Quantum + Priority -->
                    <div style="grid-column: span 2; display: flex; gap: 15px;">
                        <div style="flex: 1;">
                            <label style="color: var(--text-main);">Algorithm</label>
                            <div class="custom-select" id="algoSelect">
                                <div class="select-trigger">First Come First Serve (FCFS)</div>
                                <div class="select-options">
                                    <div class="option" data-value="FCFS">First Come First Serve (FCFS)</div>
                                    <div class="option" data-value="SJF">Shortest Job First (Non-Preemptive)</div>
                                    <div class="option" data-value="SJF_PRE">Shortest Job First (Preemptive)</div>
                                    <div class="option" data-value="PRIORITY">Priority Scheduling</div>
                                    <div class="option" data-value="RR">Round Robin</div>
                                </div>
                                <input type="hidden" id="algorithm" value="FCFS">
                            </div>
                        </div>

                        <div style="flex: 1;">
                            <label style="color: var(--text-main);">Time Quantum (for RR)</label>
                            <input type="number" id="timeQuantum" value="2" min="1">
                        </div>

                        <div style="flex: 1;">
                            <label style="color: var(--text-main);">Priority Order</label>
                            <button id="prioToggleBtn" class="priority-toggle" onclick="togglePriority()">
                                <span class="toggle-text left active">Lower #</span>
                                <span class="toggle-switch"></span>
                                <span class="toggle-text right">Higher #</span>
                            </button>
                            <input type="hidden" id="priorityMode" value="0">
                        </div>
                    </div>

                    <!-- Processes Section -->
                    <div style="grid-column: span 2;">
                        <label style="color: var(--text-main);">Processes</label>
                        <div class="process-header">
                            <span>PID</span>
                            <span>Arrival Time</span>
                            <span>Burst Time</span>
                            <span>Priority</span>
                            <span></span>
                        </div>
                        <div id="processContainer"></div>
                    </div>

                    <!-- Buttons -->
                    <div style="grid-column: span 2; display: flex; gap: 10px; margin-top: 15px;">
                        <button onclick="addProcess()" style="flex: 1;">+ Add Process</button>
                        <button onclick="runSimulation()" style="flex: 1;">Run Simulation</button>
                    </div>
                </div>

                <div class="glass-panel">
                    <table id="resultTable">
                        <thead>
                            <tr>
                                <th>PID</th>
                                <th>Arrival</th>
                                <th>Burst</th>
                                <th>Finish</th>
                                <th>
                                    <span class="desktop-only">Turnaround</span>
                                    <span class="mobile-only">T.A.T</span>
                                </th>
                                <th>Waiting</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>

                <div class="glass-panel">
                    <h3>Gantt Chart</h3>
                    <div id="ganttChart" class="gantt-chart"></div>
                    <div id="stats" class="stats"></div>
                </div>
            </div> <!-- End Main Content -->

            <div class="history-panel" id="historyPanel">
                <div class="history-title-row" onclick="toggleHistoryPanel()">
                    <h3>History</h3>
                    <div class="history-actions">
                        <button class="toggle-btn" id="historyToggleBtn" aria-label="Toggle history">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        <button class="clear-btn" onclick="event.stopPropagation(); clearHistory()">Clear</button>
                    </div>
                </div>
                <div class="history-list" id="historyList">
                    <!-- History items will be injected here -->
                    <div style="text-align: center; color: var(--text-muted); padding: 20px; font-style: italic;"
                        id="emptyHistoryMsg">
                        No runs yet.
                    </div>
                </div>
            </div>

        </div> <!-- End Layout Wrapper -->
    </div>
    <script src="script.js"></script>
</body>

</html>